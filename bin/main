#!/usr/bin/env ruby
require_relative '../lib/logic.rb'
class Game
  attr_reader :board
  def initialize
    @board = %w[0 1 2 3 4 5 6 7 8]
    @player_char = %w[X 0]
    @game = true
    @locate = ''
    @move = 0
    @tic_tac_toe = TicTacToe.new
  end

  def disply_board
    position = 0
    while position < @board.length
      if (position % 3).zero?
        puts ''
        print "---+---+---+\n"
      end
      print " #{@board[position]} |"
      position += 1
    end
    puts "\n---+---+---+"
    puts "\n\n\n"
  end

  def core_game
    0.upto(9) do
      next unless @move < @board.length

      check_input(@board, @player_char[0], @player, @locate, @used, @move)
      @move += 1
      if @move == 9
        puts "IT's a TIE !!\n"
        break
      end
      @locate = ''
      check_input(@board, @player_char[1], @player2, @locate, @used, @move)
      @move += 1
    end
  end
end

hey = Game.new

def check_input(array, player_char, player, loc, usedd, move)
  while loc.is_a?(String)
    print "#{player}, choose a position from (1-9) to place in the board: "
    loc = gets.chomp
    if loc =~ /[1-9]/ && loc.to_i.between?(1, 9) && loc.to_i <= array.length
      loc = loc.to_i
      if !@tic_tac_toe.taken?(loc, usedd)
        loc = gets.chomp.to_i
      elsif !@tic_tac_toe.taken?(loc, usedd)
        print 'This number is already taken,'
        puts 'choose another number.'
      end
      array[loc - 1] = player_char
      disply_board(array)
    elsif loc.to_i.zero?
      puts 'Zero is not part of the range (1-9)'
    elsif move == array.length
      puts "IT's a TIE !! "
      break
    elsif loc.to_i.negative?
      puts 'No negatvie numbers allowed.'
    end
  end
end

# def pseudo_empty?(player)
#   while player.empty?
#     print 'Enter a valid pseudo: '
#     player = gets.chomp
#   end
#   player
# end

system('clear') || system('cls')

# def taken?(pos, array)
#   if array.count(pos).zero? || array.empty?
#     array << pos
#     false
#   else
#     print 'This number is already taken,'
#     puts 'choose another number.'
#     true
#   end
# end

system('clear') || system('cls')
used = []
move = 0
player1 = ''
player2 = ''

system('clear') || system('cls')
puts "Welcome to our amazing Tic Tac Toe !!\n\n\n"

print 'Player 1 should enter his pseudo: '
player1 = gets.chomp
player1 = pseudo_empty?(player1) if player1.empty?
p player1
system('clear') || system('cls')

print 'Player 2 should enter his pseudo: '
player2 = gets.chomp
player2 = pseudo_empty?(player2) if player2.empty?
p player2

puts "#{player1} is going to play with X"
puts "#{player2} is going to play with O"
system('clear') || system('cls')

system('clear') || system('cls')

puts "Great ! #{player1} and #{player2} let start the battle !!\n\n\n"

hey.disply_board
hey.core_game


